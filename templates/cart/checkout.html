{% extends 'base.html' %}
{% load static %}

{% block title %}Checkout - Tulsattva{% endblock %}

{% block content %}
<div class="container-fluid py-5">
    <div class="container">
        <h1 class="page-title mb-5">Checkout</h1>

        <div class="row">
            <!-- Shipping Address -->
            <div class="col-lg-8">
                <div class="checkout-card">
                    <h4 class="card-title">Shipping Address</h4>
                    <form method="post">
                        {% csrf_token %}
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label>Full Name *</label>
                                    <input type="text" name="full_name" class="form-control" required 
                                           value="{{ user.get_full_name }}">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label>Email *</label>
                                    <input type="email" name="email" class="form-control" required
                                           value="{{ user.email }}">
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Phone Number *</label>
                            <input type="tel" name="phone" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Address *</label>
                            <textarea name="address" class="form-control" rows="3" required></textarea>
                        </div>
                        <div class="row">
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label>City *</label>
                                    <input type="text" name="city" class="form-control" required>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label>State *</label>
                                    <input type="text" name="state" class="form-control" required>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label>Pincode *</label>
                                    <input type="text" name="pincode" class="form-control" required>
                                </div>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-warning btn-lg w-100">
                            Place Order
                        </button>
                    </form>
                </div>
            </div>

            <!-- Order Summary -->
            <div class="col-lg-4">
                <div class="order-summary">
                    <h4 class="summary-title">Order Summary</h4>
                    {% for item in cart_items %}
                    <div class="order-item">
                        <div class="item-image">
                            <img src="{{ item.product.image.url }}" alt="{{ item.product.name }}">
                        </div>
                        <div class="item-details">
                            <h6>{{ item.product.name }}</h6>
                            <p>Qty: {{ item.quantity }}</p>
                            <span>₹{{ item.total_price }}</span>
                        </div>
                    </div>
                    {% endfor %}
                    
                    <div class="summary-totals">
                        <div class="total-row">
                            <span>Subtotal:</span>
                            <span>₹{{ cart.total_price }}</span>
                        </div>
                        <div class="total-row">
                            <span>Shipping:</span>
                            <span>{% if cart.total_price >= 1999 %}FREE{% else %}₹99{% endif %}</span>
                        </div>
                        <div class="total-row">
                            <span>Tax:</span>
                            <span>₹{{ cart.total_price|floatformat:2 }}</span>
                        </div>
                        <hr>
                        <div class="total-row grand-total">
                            <strong>Total:</strong>
                            <strong>₹{% if cart.total_price >= 1999 %}{{ cart.total_price }}{% else %}{{ cart.total_price|add:99 }}{% endif %}</strong>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}